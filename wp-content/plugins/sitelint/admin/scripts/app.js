"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(e,t){return e(t={exports:{}},t.exports),t.exports}var t,n,r,i=e((function(e,t){
/*!
  * Bootstrap data.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(){const e=new Map,t={set(t,n,r){e.has(t)||e.set(t,new Map);const i=e.get(t);i.has(n)||0===i.size?i.set(n,r):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`)},get:(t,n)=>e.has(t)&&e.get(t).get(n)||null,remove(t,n){if(!e.has(t))return;const r=e.get(t);r.delete(n),0===r.size&&e.delete(t)}};return t}()})),o=e((function(e,t){
/*!
  * Bootstrap index.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
!function(e){const t=1e6,n=1e3,r="transitionend",i=e=>(e&&window.CSS&&window.CSS.escape&&(e=e.replace(/#([^\s"#']+)/g,((e,t)=>`#${CSS.escape(t)}`))),e),o=e=>null==e?`${e}`:Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase(),a=e=>{do{e+=Math.floor(Math.random()*t)}while(document.getElementById(e));return e},s=e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:r}=window.getComputedStyle(e);const i=Number.parseFloat(t),o=Number.parseFloat(r);return i||o?(t=t.split(",")[0],r=r.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(r))*n):0},c=e=>{e.dispatchEvent(new Event(r))},l=e=>!(!e||"object"!=typeof e)&&(void 0!==e.jquery&&(e=e[0]),void 0!==e.nodeType),u=e=>l(e)?e.jquery?e[0]:e:"string"==typeof e&&e.length>0?document.querySelector(i(e)):null,d=e=>{if(!l(e)||0===e.getClientRects().length)return!1;const t="visible"===getComputedStyle(e).getPropertyValue("visibility"),n=e.closest("details:not([open])");if(!n)return t;if(n!==e){const t=e.closest("summary");if(t&&t.parentNode!==n)return!1;if(null===t)return!1}return t},p=e=>!e||e.nodeType!==Node.ELEMENT_NODE||!!e.classList.contains("disabled")||(void 0!==e.disabled?e.disabled:e.hasAttribute("disabled")&&"false"!==e.getAttribute("disabled")),h=e=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){const t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?h(e.parentNode):null},g=()=>{},m=e=>{e.offsetHeight},f=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,y=[],w=e=>{"loading"===document.readyState?(y.length||document.addEventListener("DOMContentLoaded",(()=>{for(const e of y)e()})),y.push(e)):e()},b=()=>"rtl"===document.documentElement.dir,A=e=>{w((()=>{const t=f();if(t){const n=e.NAME,r=t.fn[n];t.fn[n]=e.jQueryInterface,t.fn[n].Constructor=e,t.fn[n].noConflict=()=>(t.fn[n]=r,e.jQueryInterface)}}))},v=(e,t=[],n=e)=>"function"==typeof e?e(...t):n,E=(e,t,n=!0)=>{if(!n)return void v(e);const i=5,o=s(t)+i;let a=!1;const l=({target:n})=>{n===t&&(a=!0,t.removeEventListener(r,l),v(e))};t.addEventListener(r,l),setTimeout((()=>{a||c(t)}),o)},S=(e,t,n,r)=>{const i=e.length;let o=e.indexOf(t);return-1===o?!n&&r?e[i-1]:e[0]:(o+=n?1:-1,r&&(o=(o+i)%i),e[Math.max(0,Math.min(o,i-1))])};e.defineJQueryPlugin=A,e.execute=v,e.executeAfterTransition=E,e.findShadowRoot=h,e.getElement=u,e.getNextActiveElement=S,e.getTransitionDurationFromElement=s,e.getUID=a,e.getjQuery=f,e.isDisabled=p,e.isElement=l,e.isRTL=b,e.isVisible=d,e.noop=g,e.onDOMContentLoaded=w,e.parseSelector=i,e.reflow=m,e.toType=o,e.triggerTransitionEnd=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}(t)})),a=e((function(e,t){
/*!
  * Bootstrap event-handler.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(e){const t=/[^.]*(?=\..*)\.|.*/,n=/\..*/,r=/::\d+$/,i={};let o=1;const a={mouseenter:"mouseover",mouseleave:"mouseout"},s=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function c(e,t){return t&&`${t}::${o++}`||e.uidEvent||o++}function l(e){const t=c(e);return e.uidEvent=t,i[t]=i[t]||{},i[t]}function u(e,t){return function n(r){return b(r,{delegateTarget:e}),n.oneOff&&w.off(e,r.type,t),t.apply(e,[r])}}function d(e,t,n){return function r(i){const o=e.querySelectorAll(t);for(let{target:a}=i;a&&a!==this;a=a.parentNode)for(const s of o)if(s===a)return b(i,{delegateTarget:a}),r.oneOff&&w.off(e,i.type,t,n),n.apply(a,[i])}}function p(e,t,n=null){return Object.values(e).find((e=>e.callable===t&&e.delegationSelector===n))}function h(e,t,n){const r="string"==typeof t,i=r?n:t||n;let o=y(e);return s.has(o)||(o=e),[r,i,o]}function g(e,n,r,i,o){if("string"!=typeof n||!e)return;let[s,g,m]=h(n,r,i);if(n in a){const e=e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)};g=e(g)}const f=l(e),y=f[m]||(f[m]={}),w=p(y,g,s?r:null);if(w)return void(w.oneOff=w.oneOff&&o);const b=c(g,n.replace(t,"")),A=s?d(e,r,g):u(e,g);A.delegationSelector=s?r:null,A.callable=g,A.oneOff=o,A.uidEvent=b,y[b]=A,e.addEventListener(m,A,s)}function m(e,t,n,r,i){const o=p(t[n],r,i);o&&(e.removeEventListener(n,o,Boolean(i)),delete t[n][o.uidEvent])}function f(e,t,n,r){const i=t[n]||{};for(const[o,a]of Object.entries(i))o.includes(r)&&m(e,t,n,a.callable,a.delegationSelector)}function y(e){return e=e.replace(n,""),a[e]||e}const w={on(e,t,n,r){g(e,t,n,r,!1)},one(e,t,n,r){g(e,t,n,r,!0)},off(e,t,n,i){if("string"!=typeof t||!e)return;const[o,a,s]=h(t,n,i),c=s!==t,u=l(e),d=u[s]||{},p=t.startsWith(".");if(void 0===a){if(p)for(const n of Object.keys(u))f(e,u,n,t.slice(1));for(const[n,i]of Object.entries(d)){const o=n.replace(r,"");c&&!t.includes(o)||m(e,u,s,i.callable,i.delegationSelector)}}else{if(!Object.keys(d).length)return;m(e,u,s,a,o?n:null)}},trigger(t,n,r){if("string"!=typeof n||!t)return null;const i=e.getjQuery();let o=null,a=!0,s=!0,c=!1;n!==y(n)&&i&&(o=i.Event(n,r),i(t).trigger(o),a=!o.isPropagationStopped(),s=!o.isImmediatePropagationStopped(),c=o.isDefaultPrevented());const l=b(new Event(n,{bubbles:a,cancelable:!0}),r);return c&&l.preventDefault(),s&&t.dispatchEvent(l),l.defaultPrevented&&o&&o.preventDefault(),l}};function b(e,t={}){for(const[n,r]of Object.entries(t))try{e[n]=r}catch(t){Object.defineProperty(e,n,{configurable:!0,get:()=>r})}return e}return w}(o)})),s=e((function(e,t){
/*!
  * Bootstrap manipulator.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(){function e(e){if("true"===e)return!0;if("false"===e)return!1;if(e===Number(e).toString())return Number(e);if(""===e||"null"===e)return null;if("string"!=typeof e)return e;try{return JSON.parse(decodeURIComponent(e))}catch(t){return e}}function t(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}return{setDataAttribute(e,n,r){e.setAttribute(`data-bs-${t(n)}`,r)},removeDataAttribute(e,n){e.removeAttribute(`data-bs-${t(n)}`)},getDataAttributes(t){if(!t)return{};const n={},r=Object.keys(t.dataset).filter((e=>e.startsWith("bs")&&!e.startsWith("bsConfig")));for(const i of r){let r=i.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1,r.length),n[r]=e(t.dataset[i])}return n},getDataAttribute:(n,r)=>e(n.getAttribute(`data-bs-${t(r)}`))}}()})),c=e((function(e,t){
/*!
  * Bootstrap config.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(e,t){class n{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(n,r){const i=t.isElement(r)?e.getDataAttribute(r,"config"):{};return{...this.constructor.Default,..."object"==typeof i?i:{},...t.isElement(r)?e.getDataAttributes(r):{},..."object"==typeof n?n:{}}}_typeCheckConfig(e,n=this.constructor.DefaultType){for(const[r,i]of Object.entries(n)){const n=e[r],o=t.isElement(n)?"element":t.toType(n);if(!new RegExp(i).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${o}" but expected type "${i}".`)}}}return n}(s,o)})),l=e((function(e,t){
/*!
  * Bootstrap base-component.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(e,t,n,r){const i="5.3.1";class o extends n{constructor(t,n){super(),(t=r.getElement(t))&&(this._element=t,this._config=this._getConfig(n),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),t.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,n=!0){r.executeAfterTransition(e,t,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(t){return e.get(r.getElement(t),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,"object"==typeof t?t:null)}static get VERSION(){return i}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}return o}(i,a,c,o)})),u=e((function(e,t){
/*!
  * Bootstrap selector-engine.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(e){const t=t=>{let n=t.getAttribute("data-bs-target");if(!n||"#"===n){let e=t.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),n=e&&"#"!==e?e.trim():null}return e.parseSelector(n)},n={find:(e,t=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(t,e)),findOne:(e,t=document.documentElement)=>Element.prototype.querySelector.call(t,e),children:(e,t)=>[].concat(...e.children).filter((e=>e.matches(t))),parents(e,t){const n=[];let r=e.parentNode.closest(t);for(;r;)n.push(r),r=r.parentNode.closest(t);return n},prev(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return[n];n=n.previousElementSibling}return[]},next(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return[n];n=n.nextElementSibling}return[]},focusableChildren(t){const n=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map((e=>`${e}:not([tabindex^="-"])`)).join(",");return this.find(n,t).filter((t=>!e.isDisabled(t)&&e.isVisible(t)))},getSelectorFromElement(e){const r=t(e);return r&&n.findOne(r)?r:null},getElementFromSelector(e){const r=t(e);return r?n.findOne(r):null},getMultipleElementsFromSelector(e){const r=t(e);return r?n.find(r):[]}};return n}(o)}));e((function(e,t){
/*!
  * Bootstrap tab.js v5.3.1 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
e.exports=function(e,t,n,r){const i="tab",o=".bs.tab",a=`hide${o}`,s=`hidden${o}`,c=`show${o}`,l=`shown${o}`,u=`click${o}`,d=`keydown${o}`,p=`load${o}`,h="ArrowLeft",g="ArrowRight",m="ArrowUp",f="ArrowDown",y="Home",w="End",b="active",A="fade",v="show",E="dropdown",S=".dropdown-toggle",T=".dropdown-menu",_=":not(.dropdown-toggle)",C='.list-group, .nav, [role="tablist"]',k=".nav-item, .list-group-item",D='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',O=`.nav-link${_}, .list-group-item${_}, [role="tab"]${_}, ${D}`,L=`.${b}[data-bs-toggle="tab"], .${b}[data-bs-toggle="pill"], .${b}[data-bs-toggle="list"]`;class P extends e{constructor(e){super(e),this._parent=this._element.closest(C),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),t.on(this._element,d,(e=>this._keydown(e))))}static get NAME(){return i}show(){const e=this._element;if(this._elemIsActive(e))return;const n=this._getActiveElem(),r=n?t.trigger(n,a,{relatedTarget:e}):null;t.trigger(e,c,{relatedTarget:n}).defaultPrevented||r&&r.defaultPrevented||(this._deactivate(n,e),this._activate(e,n))}_activate(e,r){if(!e)return;e.classList.add(b),this._activate(n.getElementFromSelector(e));const i=()=>{"tab"===e.getAttribute("role")?(e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),t.trigger(e,l,{relatedTarget:r})):e.classList.add(v)};this._queueCallback(i,e,e.classList.contains(A))}_deactivate(e,r){if(!e)return;e.classList.remove(b),e.blur(),this._deactivate(n.getElementFromSelector(e));const i=()=>{"tab"===e.getAttribute("role")?(e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),t.trigger(e,s,{relatedTarget:r})):e.classList.remove(v)};this._queueCallback(i,e,e.classList.contains(A))}_keydown(e){if(![h,g,m,f,y,w].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter((e=>!r.isDisabled(e)));let n;if([y,w].includes(e.key))n=t[e.key===y?0:t.length-1];else{const i=[g,f].includes(e.key);n=r.getNextActiveElement(t,e.target,i,!0)}n&&(n.focus({preventScroll:!0}),P.getOrCreateInstance(n).show())}_getChildren(){return n.find(O,this._parent)}_getActiveElem(){return this._getChildren().find((e=>this._elemIsActive(e)))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute("aria-selected",t),n!==e&&this._setAttributeIfNotExists(n,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=n.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const r=this._getOuterElement(e);if(!r.classList.contains(E))return;const i=(e,i)=>{const o=n.findOne(e,r);o&&o.classList.toggle(i,t)};i(S,b),i(T,v),r.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(b)}_getInnerElement(e){return e.matches(O)?e:n.findOne(O,e)}_getOuterElement(e){return e.closest(k)||e}static jQueryInterface(e){return this.each((function(){const t=P.getOrCreateInstance(this);if("string"==typeof e){if(void 0===t[e]||e.startsWith("_")||"constructor"===e)throw new TypeError(`No method named "${e}"`);t[e]()}}))}}return t.on(document,u,D,(function(e){["A","AREA"].includes(this.tagName)&&e.preventDefault(),r.isDisabled(this)||P.getOrCreateInstance(this).show()})),t.on(window,p,(()=>{for(const e of n.find(L))P.getOrCreateInstance(e)})),r.defineJQueryPlugin(P),P}(l,a,u,o)})),function(e){e[e.OK=200]="OK"}(t||(t={})),function(e){e.viaWordpressPlugin="viaWordpressPlugin"}(n||(n={}));class d{postDataToPage(e,t){const n=document.createElement("form");n.method="POST",n.action=window.location.href;for(const e in t)if(t.hasOwnProperty(e)){const r=document.createElement("input");r.type="hidden",r.name=e,r.value=t[e],n.appendChild(r)}const r=document.createElement("input");r.type="hidden",r.name="_action",r.value=e,n.appendChild(r),document.body.appendChild(n),n.submit()}checkUserEmail(e){const t={_action:"checkEmail",email:e};let n=[];for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=window.encodeURIComponent(e),i=window.encodeURIComponent(t[e]);n.push(`${r}=${i}`)}n=n.join("&");const r={body:n,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},method:"POST"},i=window.location.href;return window.fetch(i,r)}logIn(e,t){const n={deriveKey:t,email:e};this.postDataToPage("login",n)}signUp(e){this.postDataToPage("register",e)}logOut(){this.postDataToPage("disable",{})}getWorkspaceTokens(e){this.postDataToPage("loadWorkspaceTokens",e)}updateApiToken(e){this.postDataToPage("updateToken",e)}clearApiToken(){this.postDataToPage("clearToken",{})}clearWorkspace(){this.postDataToPage("clearWorkspace",{})}allowSiteLint(){this.postDataToPage("allowSiteLint",{})}addSiteLintLogo(){this.postDataToPage("addSiteLintLogo",{})}}class p{static localeNumbers(){Array.from(document.querySelectorAll("[data-site-locale-number]")).forEach((e=>{e.textContent=Number(e.textContent).toLocaleString()}))}static getPreferredAvailableLanguageAndRegion(){return"string"==typeof window.navigator.language&&window.navigator.language.length>0?window.navigator.language:Array.isArray(window.navigator.languages)&&window.navigator.languages.length>0?window.navigator.languages[0]:"en-us"}static isHostMethod(e,t){if(!e)return!1;const n=typeof e[t];return/^unknown$/.test(n)||/^(function|object)$/.test(n)&&Boolean(e)||!1}static isRealObjectProperty(e,t){return e&&Boolean("object"==typeof e[t]&&e[t])}static isHtmlElement(e){try{return e&&e instanceof Element||e instanceof Document}catch(t){return e&&"object"==typeof e&&e.nodeType===Node.ELEMENT_NODE&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}static getStyle(e,t,n){return!1===p.isHtmlElement(e)?null:p.isHostMethod(window,"getComputedStyle")?window.getComputedStyle(e,n||null).getPropertyValue(t):document.defaultView&&p.isRealObjectProperty(document,"defaultView")?document.defaultView.getComputedStyle(e,n||null).getPropertyValue(t):null}static htmlDecode(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}}let h;!function(e){e.aes_gsm="AES-GCM",e.a256gcm="A256GCM",e.sha_512="SHA-512",e.rsa_oaep="RSA-OAEP",e.pbkdf2="PBKDF2"}(r||(r={}));!1==="CompressionStream"in globalThis&&(async()=>{await import("./pako.esm-16c94e38.js").then((e=>{h=e.default}))})();class g{static isCompressionStreamSupported="CompressionStream"in globalThis;static compress(e,t="gzip"){if(g.isCompressionStreamSupported){let n;n="string"==typeof e?(new TextEncoder).encode(e):e instanceof Uint8Array?e:new Uint8Array(e);const r=new window.CompressionStream(t),i=r.writable.getWriter();return i.write(n),i.close(),new Response(r.readable).arrayBuffer()}return Promise.resolve(h.gzip(e))}static decompress(e,t="gzip"){if(g.isCompressionStreamSupported){let n;n="string"==typeof e?(new TextEncoder).encode(e):e instanceof Uint8Array?e:new Uint8Array(e);const r=new window.DecompressionStream(t),i=r.writable.getWriter();return i.write(n),i.close(),new Response(r.readable).arrayBuffer().then((e=>(new TextDecoder).decode(e)))}return Promise.resolve(h.ungzip(e,{to:"string"}))}}const m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=function(){const e=[];for(let t=0,n=64;t<n;++t)e[m.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}();class y{static BASE64_SEPARATOR="|";static createKey(){return new Promise(((e,t)=>{const n={hash:{name:r.sha_512},modulusLength:4096,name:"RSASSA-PKCS1-v1_5",publicExponent:new Uint8Array([1,0,1])};window.crypto.subtle.generateKey(n,!0,["sign","verify"]).then((async t=>{const n=await window.crypto.subtle.exportKey("pkcs8",t.privateKey),r=await window.crypto.subtle.exportKey("spki",t.publicKey),i={privateKey:new Uint8Array(n),publicKey:new Uint8Array(r)};e(i)}),t)}))}static createAESKey(e){return new Promise(((t,n)=>{const i={length:e,name:r.aes_gsm};window.crypto.subtle.generateKey(i,!0,["encrypt","decrypt"]).then((async e=>{const n=await window.crypto.subtle.exportKey("jwk",e);t(n.k)}),n)}))}static async genEncryptionKey(e,t,n,i){const o={hash:r.sha_512,iterations:1e3,name:"PBKDF2",salt:n},a={length:i,name:t},s=(new TextEncoder).encode(e),c={generator:new Uint8Array(12),name:"PBKDF2",prime:new Uint8Array(12)},l=await window.crypto.subtle.importKey("raw",s,c,!1,["deriveKey"]);return window.crypto.subtle.deriveKey(o,l,a,!0,["encrypt","decrypt"])}static uint8ToString(e,t){const n=[];let r=0;if("TextDecoder"in window)return new TextDecoder(t).decode(new DataView(e.buffer));for(;r<e.length;){let t=e[r++];t<128||(t<224?(t=(31&t)<<6,t|=63&e[r++]):t<240?(t=(15&t)<<12,t|=(63&e[r++])<<6,t|=63&e[r++]):(t=(7&t)<<18,t|=(63&e[r++])<<12,t|=(63&e[r++])<<6,t|=63&e[r++])),n.push(String.fromCharCode(t))}return n.join("")}static uint8ToBase64(e){let t=0;const n=[];let r,i=0|e.length/3;for(;i-- >0;)r=(e[t]<<16)+(e[t+1]<<8)+e[t+2],t+=3,n.push(m.charAt(63&r>>18)),n.push(m.charAt(63&r>>12)),n.push(m.charAt(63&r>>6)),n.push(m.charAt(63&r));return e.length-t==2?(r=(e[t]<<16)+(e[t+1]<<8),n.push(m.charAt(63&r>>18)),n.push(m.charAt(63&r>>12)),n.push(m.charAt(63&r>>6)),n.push("=")):e.length-t==1&&(r=e[t]<<16,n.push(m.charAt(63&r>>18)),n.push(m.charAt(63&r>>12)),n.push("==")),n.join("")}static stringToUint8(e){const t=new ArrayBuffer(4*e.length);let n,r,i;if("TextEncoder"in window)return(new TextEncoder).encode(e);for(n=new Uint8Array(t),r=0,i=0;r<e.length;r+=1){const t=e.charCodeAt(r);t<128?(n[i]=t,i++):t<2048?(n[i]=192|t>>6,n[i+1]=128|63&t,i+=2):t<65536?(n[i]=224|t>>12,n[i+1]=128|63&t>>6,n[i+2]=128|63&t,i+=3):(n[i]=240|t>>18,n[i+1]=128|63&t>>12,n[i+2]=128|63&t>>6,n[i+3]=128|63&t,i+=4)}return n=new Uint8Array(n.subarray(0,i)),n}static base64ToUint8(e){let t=0;const n=[];let r=e.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string")}let i=0|r.length/4;for(;i-- >0;){const e=(f[r.charCodeAt(t)]<<18)+(f[r.charCodeAt(t+1)]<<12)+(f[r.charCodeAt(t+2)]<<6)+f[r.charCodeAt(t+3)];n.push(255&e>>16),n.push(255&e>>8),n.push(255&e),t+=4}return n&&("="===r.charAt(t-2)?(n.pop(),n.pop()):"="===r.charAt(t-1)&&n.pop()),new Uint8Array(n)}static async decryptWithUserPassword(e,t,n){const i=r.aes_gsm,o=await this.genEncryptionKey(t,i,n,256),a={iv:n,name:i};return new Uint8Array(await window.crypto.subtle.decrypt(a,o,e))}static async encryptWithUserPassword(e,t){const n=r.aes_gsm,i=crypto.getRandomValues(new Uint8Array(12)),o=await this.genEncryptionKey(t,n,i,256),a={iv:i,name:n};return{salt:i,uint:new Uint8Array(await window.crypto.subtle.encrypt(a,o,e))}}static async encryptWithUserPasswordAndSalt(e,t,n){const i=r.aes_gsm,o=await this.genEncryptionKey(t,i,n,256),a={iv:n,name:i};return{salt:n,uint:new Uint8Array(await window.crypto.subtle.encrypt(a,o,e))}}static async decryptWithPrivateKey(e,t){const n={name:r.rsa_oaep},i=await window.crypto.subtle.decrypt(n,e,t);return new Uint8Array(i)}static normalizeDataToUint(e){return"string"==typeof e||"boolean"===e||"number"===e?this.stringToUint8(e):e}static async encryptWithPublicKey(e,t){const n={name:r.rsa_oaep},i=await window.crypto.subtle.encrypt(n,e,this.normalizeDataToUint(t));return new Uint8Array(i)}static async encryptDeriveKey(e){const t=await window.crypto.subtle.exportKey("raw",e);return new Uint8Array(t)}static encryptData(e,t,n,i=!0){return new Promise((async(o,a)=>{const s=this.normalizeDataToUint(i?g.compress(n):n),c=crypto.getRandomValues(new Uint8Array(12)),l={iv:c,name:r.aes_gsm,tagLength:128},u={encryptedSalt:new Uint8Array,uint:new Uint8Array};try{u.encryptedSalt=await this.encryptWithPublicKey(e,c),u.uint=new Uint8Array(await window.crypto.subtle.encrypt(l,t,s))}catch(e){return void a(e)}o(u)}))}static decryptData(e,t,n,i=!0){return new Promise((async(o,a)=>{let s;try{s=await this.decryptWithPrivateKey(e,n.encryptedSalt)}catch(e){return console.error(e),void a(e)}const c={iv:s,name:r.aes_gsm,tagLength:128},l=await window.crypto.subtle.decrypt(c,t,n.uint),u=new Uint8Array(l);o(i?g.decompress(u):u)}))}static async encryptFileWithPublicKey(e,t,n){const r=await n.arrayBuffer(),i=await y.encryptData(e,t,new Uint8Array(r)),o=`${y.uint8ToBase64(i.uint)}${y.BASE64_SEPARATOR}${y.uint8ToBase64(i.encryptedSalt)}`;return new File([o],n.name,{type:n.type})}static importPublicKey(e){const t={hash:{name:r.sha_512},name:r.rsa_oaep};return window.crypto.subtle.importKey("spki",e,t,!1,["encrypt"])}static importPrivateKey(e){const t={hash:{name:r.sha_512},name:r.rsa_oaep};return window.crypto.subtle.importKey("pkcs8",e,t,!1,["decrypt"])}static importAESKey(e){const t={alg:r.a256gcm,ext:!1,k:e,kty:"oct"},n={length:256,name:r.aes_gsm};return window.crypto.subtle.importKey("jwk",t,n,!1,["encrypt","decrypt"])}static splitEncryptedPrivateKey(e){const t=e.split(this.BASE64_SEPARATOR)[0],n=e.split(this.BASE64_SEPARATOR)[1];return{salt:this.base64ToUint8(n),uint:this.base64ToUint8(t)}}static createCryptData(e){return new Promise((async(t,n)=>{let r,i,o,a,s,c,l,u;try{r=await this.createKey(),i=await this.createAESKey(256),o=await this.importPublicKey(r.publicKey),a=await this.encryptWithUserPassword(r.privateKey,e),s=`${this.uint8ToBase64(a.uint)}${this.BASE64_SEPARATOR}${this.uint8ToBase64(a.salt)}`,c=this.uint8ToBase64(r.publicKey),l=await this.encryptWithPublicKey(o,i),u=this.uint8ToBase64(l)}catch(e){return void n(e)}t({aesKey:u,privateKey:s,publicKey:c})}))}}class w{static determineUserTimeZone(){let e=null;try{e=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){console.warn("[DateUtility.determineUserTimeZone] Intl.DateTimeFormat not supported",e)}return e}}class b{apiService;constructor(){this.apiService=new d}getEmail(e){const t=e.querySelector("[data-form-login]");return t?.value}getPassword(e){const t=e.querySelector("[data-form-password]");return t?.value}getDisplayName(e){const t=e.querySelector("[data-form-displayName]");return t?.value}getApiToken(e){const t=e.querySelector("[data-form-api-token]");return t?.value}getWorkspace(e){const t=e.querySelector("[data-form-workspace]");return t?.value}handleApiError(e,t){console.log(e,t)}async successCheckUserEmail(e,t){try{const n=await y.genEncryptionKey(this.getPassword(t),"AES-GCM",y.base64ToUint8(e.salt),256),r=await y.encryptDeriveKey(n);this.apiService.logIn(this.getEmail(t),y.uint8ToBase64(r))}catch(t){return console.error("[HomeComponent.successCheckUserEmail]",null,t),void this.handleApiError(e,t)}}async handleLogInAction(e){e.preventDefault();const n=e.target,r=this.getEmail(n);let i=null;try{i=await this.apiService.checkUserEmail(r)}catch(e){return void console.error(e)}if(null===i||i.status!==t.OK)return void console.error("[HomeComponent.handleLogInAction] Error while checking email",i);const o=await i.text(),a=JSON.parse(p.htmlDecode(o));this.successCheckUserEmail(a,n)}async handleSignUpAction(e){e.preventDefault();const t=e.target,r=this.getPassword(t);let i=null;try{i=await y.createCryptData(r)}catch(e){return void console.error("[HomeComponent.handleSignUpAction]",e)}const o=new Date,a={aesKey:i.aesKey,companyDomain:"",companyName:"",createdVia:n.viaWordpressPlugin,displayName:this.getDisplayName(t),email:this.getEmail(t),privateKey:i.privateKey,publicKey:i.publicKey,timezone:w.determineUserTimeZone(),timezoneOffset:o.getTimezoneOffset(),userLanguage:p.getPreferredAvailableLanguageAndRegion()};try{this.apiService.signUp(a)}catch(e){return void console.error(e)}}initialiseLogIn(){const e=document.querySelector("#logInForm");null!==e&&e.addEventListener("submit",this.handleLogInAction.bind(this))}initialiseSignUp(){const e=document.querySelector("#signUpForm");null!==e&&e.addEventListener("submit",this.handleSignUpAction.bind(this))}initialiseLogOut(){const e=document.querySelector("#logOutBtn");null!==e&&e.addEventListener("click",this.handleLogOutAction.bind(this))}initialiseUpdateToken(){const e=document.querySelector("#apiTokenForm");null!==e&&e.addEventListener("submit",this.handleUpdateTokenAction.bind(this))}initialiseClearToken(){const e=document.querySelector("#clearToken");null!==e&&e.addEventListener("click",this.handleClearTokenAction.bind(this))}initialiseWorkspaceToken(){const e=document.querySelector("#clearWorkspace");null!==e&&e.addEventListener("click",this.handleClearWorkspaceAction.bind(this))}initialiseAllowSiteLint(){const e=document.querySelector("#allowSiteLint");null!==e&&e.addEventListener("change",this.handleAllowSiteLintAction.bind(this))}initialiseAddSiteLintLogo(){const e=document.querySelector("#addSiteLintLogo");null!==e&&e.addEventListener("change",this.handleAddSiteLintLogoAction.bind(this))}handleLogOutAction(e){e.preventDefault(),this.apiService.logOut()}handleUpdateTokenAction(e){e.preventDefault();const t=e.target;let n={workspace:this.getWorkspace(t)};if(this.getApiToken(t))return n={apiToken:this.getApiToken(t)},void this.apiService.updateApiToken(n);this.apiService.getWorkspaceTokens(n)}handleClearTokenAction(e){e.preventDefault(),this.apiService.clearApiToken()}handleClearWorkspaceAction(e){e.preventDefault(),this.apiService.clearWorkspace()}handleAllowSiteLintAction(e){e.preventDefault(),this.apiService.allowSiteLint()}handleAddSiteLintLogoAction(e){e.preventDefault(),this.apiService.addSiteLintLogo()}init(){this.initialiseLogIn(),this.initialiseLogOut(),this.initialiseSignUp(),this.initialiseUpdateToken(),this.initialiseClearToken(),this.initialiseWorkspaceToken(),this.initialiseAllowSiteLint(),this.initialiseAddSiteLintLogo()}}class A{static polyfill(){"object"!=typeof globalThis&&(Object.defineProperty(Object.prototype,"__magic__",{configurable:!0,get:function(){return this}}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)}}const v=new class{homeComponent;constructor(){this.homeComponent=new b,A.polyfill()}init(e){p.localeNumbers(),this.homeComponent.init()}};"complete"===document.readyState?v.init():window.addEventListener("DOMContentLoaded",v.init.bind(v));
